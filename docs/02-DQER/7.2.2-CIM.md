# Módulo: Captura de Imagens
- **Sigla:** CIM
- **Status:** ⬜ Em definição

- **Implementação:**
  - ✅ Backend
  - ❌ Frontend
  - ✅ Mobile
  - ❌ Backoffice

> **Legenda:** ⬜ Pendente | ✅ Realizado | ⚠️ Ponto de atenção | ❌ Não se aplica

## Descrição
Este módulo fornece a interface e as ferramentas para a captura padronizada de fotografias clínicas. É uma das funcionalidades centrais do sistema, projetada para garantir consistência e precisão no registro fotográfico através de guias visuais, modo fantasma e associação direta das imagens ao prontuário do paciente, evitando o uso da galeria pública do dispositivo.

## Escopo Inicial
- Acesso à câmera do dispositivo através de uma interface otimizada.
- Seleção de guias de alinhamento (molduras) para diferentes procedimentos.
- Funcionalidade de "modo fantasma" para sobrepor uma imagem de referência.
- Associação da imagem capturada a um paciente e sessão específicos.

## Funcionalidades
- **Interface de Câmera:** Apresenta a visualização da câmera com controles essenciais (flash, troca de câmera, etc.).
- **Seleção de Molduras:** Permite ao usuário escolher uma moldura (guia de contorno) para padronizar o enquadramento.
- **Modo Fantasma:** Sobrepõe uma foto anterior do mesmo paciente com transparência ajustável para garantir consistência entre sessões.
- **Captura e Salvamento Seguro:** Tira a foto e a salva diretamente no armazenamento seguro do aplicativo, vinculada ao paciente.

## Requisitos Funcionais

- **RF-CIM-001:** Acesso à Câmera
  - **Descrição:** O sistema deve solicitar e obter permissão para acessar a câmera do dispositivo móvel.
  - **Critério de aceitação:** A interface de captura é exibida com sucesso após a permissão do usuário.
  - **Prioridade:** Altíssima

- **RF-CIM-002:** Exibição de Guias de Alinhamento (Molduras)
  - **Descrição:** O usuário deve poder selecionar e visualizar sobre a câmera uma moldura de alinhamento específica para o procedimento (ex: rosto, perfil, abdômen).
  - **Critério de aceitação:** A moldura selecionada é exibida corretamente sobre a imagem da câmera.
  - **Prioridade:** Alta

- **RF-CIM-003:** Ativação do Modo Fantasma
  - **Descrição:** O usuário deve poder selecionar uma foto anterior do paciente e exibi-la como uma camada semitransparente (fantasma) sobre a câmera para auxiliar no posicionamento.
  - **Critério de aceitação:** A imagem fantasma é exibida e o usuário pode ajustar seu nível de transparência.
  - **Prioridade:** Alta

- **RF-CIM-004:** Associação da Foto ao Paciente
  - **Descrição:** O sistema deve garantir que toda foto capturada seja obrigatoriamente associada a um paciente e a uma sessão de tratamento.
  - **Critério de aceitação:** A foto é salva e vinculada corretamente ao histórico do paciente selecionado.
  - **Prioridade:** Altíssima

## Requisitos Não Funcionais

- **RNF-CIM-001:** Performance da Câmera
  - **Descrição:** A interface de captura deve iniciar em menos de 2 segundos. O tempo entre o toque para capturar e a foto ser tirada (shutter lag) deve ser mínimo.
  - **Critério de aceitação:** O aplicativo permanece responsivo durante todo o processo de captura.
  - **Prioridade:** Alta

- **RNF-CIM-002:** Usabilidade da Interface
  - **Descrição:** Os controles da câmera (flash, troca de câmera, molduras, modo fantasma) devem ser de fácil acesso e intuitivos para o profissional.
  - **Critério de aceitação:** Testes de usabilidade indicam que um novo usuário consegue operar as funções principais sem treinamento extensivo.
  - **Prioridade:** Alta

- **RNF-CIM-003:** Armazenamento Seguro
  - **Descrição:** As fotos capturadas não devem ser salvas na galeria pública do dispositivo (ex: Rolo da Câmera, Google Fotos). Devem ser armazenadas em um diretório privado e criptografado do aplicativo.
  - **Critério de aceitação:** Nenhuma foto tirada pelo app é encontrada na galeria pública.
  - **Prioridade:** Altíssima

## Dependências

- **Histórico Clínico Fotográfico (HCF):** Para buscar a imagem de referência para o modo fantasma e para onde a nova foto será enviada.
- **Armazenamento (STOR):** Para salvar a imagem capturada de forma segura.
