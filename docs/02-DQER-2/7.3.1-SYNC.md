# Módulo: Sincronização
- **Sigla:** SYNC
- **Status:** ⬜ Em definição

- **Implementação:**
  - ✅ Backend
  - ⬜ Frontend
  - ✅ Mobile
  - ⬜ Backoffice

> **Legenda:** ⬜ Pendente | ✅ Realizado | ⚠️ Ponto de atenção | ❌ Não se aplica

## Descrição
Este módulo é responsável por manter a consistência dos dados entre múltiplos dispositivos autorizados de uma mesma clínica e o servidor central. Ele gerencia o fluxo de upload e download de informações, garantindo que um profissional possa capturar uma foto em um dispositivo e, em seguida, visualizá-la em outro dispositivo na sala de consulta, por exemplo.

## Escopo Inicial
- Sincronização automática em segundo plano.
- Fila de upload para novas fotos e dados.
- Verificação de atualizações no servidor para download de novos dados.
- Tratamento de conflitos básicos (estratégia 'último a salvar vence').

## Funcionalidades
- **Sincronização em Background:** Executa a sincronização de forma transparente para o usuário, sem interromper o fluxo de trabalho.
- **Indicador de Status:** Mostra um indicador visual na interface sobre o estado da sincronização (sincronizando, atualizado, offline).
- **Sincronização Manual:** Permite ao usuário forçar uma sincronização através de um botão.

## Requisitos Funcionais

- **RF-SYNC-001:** Sincronização Automática
  - **Descrição:** O sistema deve detectar novas informações (fotos, anotações) e adicioná-las a uma fila de upload para o servidor.
  - **Critério de aceitação:** Novos dados são enviados para o servidor em até 5 minutos após sua criação, se houver conexão.
  - **Prioridade:** Altíssima

- **RF-SYNC-002:** Atualização de Dados Locais
  - **Descrição:** O sistema deve verificar periodicamente se há novos dados no servidor e baixá-los para o dispositivo local.
  - **Critério de aceitação:** Dados criados em outro dispositivo aparecem no dispositivo atual após uma sincronização bem-sucedida.
  - **Prioridade:** Altíssima

- **RF-SYNC-003:** Operação Offline
  - **Descrição:** O aplicativo deve permanecer funcional (capturar fotos, criar anotações) mesmo sem conexão com a internet. Os novos dados devem ser sincronizados assim que a conexão for restabelecida.
  - **Critério de aceitação:** É possível criar pacientes, fotos e anotações offline. Os dados são sincronizados com sucesso quando a rede volta.
  - **Prioridade:** Alta

## Requisitos Não Funcionais

- **RNF-SYNC-001:** Otimização de Bateria e Dados
  - **Descrição:** O processo de sincronização deve ser otimizado para minimizar o consumo de bateria e o uso de dados móveis (ex: preferir Wi-Fi, sincronizar em lotes).
  - **Critério de aceitação:** A sincronização não deve consumir mais que 10% da bateria durante uma hora de uso intenso.
  - **Prioridade:** Alta

- **RNF-SYNC-002:** Resiliência a Falhas de Rede
  - **Descrição:** A sincronização deve ser capaz de pausar e continuar de onde parou em caso de perda de conexão.
  - **Critério de aceitação:** Um upload interrompido é retomado do ponto de falha, sem corromper o arquivo.
  - **Prioridade:** Alta

## Dependências

- **Armazenamento (STOR):** Para acessar os dados que precisam ser sincronizados e para salvar os dados recebidos.
